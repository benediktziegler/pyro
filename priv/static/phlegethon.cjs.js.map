{
  "version": 3,
  "sources": ["../../assets/js/phlegethon/index.js"],
  "sourcesContent": ["// #############################################################################\n// ####    T H E M E    M A N A G E M E N T\n// #############################################################################\n\n// Load user or system preference for dark or light theme\nif (\n  localStorage.theme === 'dark' ||\n  (!('theme' in localStorage) &&\n    window.matchMedia('(prefers-color-scheme: dark)').matches)\n) {\n  document.documentElement.classList.add('dark')\n} else {\n  document.documentElement.classList.remove('dark')\n}\n\n// Set theme to dark\nwindow.addEventListener('phlegethon:theme-dark', (e) => {\n  localStorage.theme = 'dark'\n  document.documentElement.classList.add('dark')\n})\n\n// Set theme to light\nwindow.addEventListener('phlegethon:theme-light', (e) => {\n  localStorage.theme = 'light'\n  document.documentElement.classList.remove('dark')\n})\n\n// Set theme to system preference\nwindow.addEventListener('phlegethon:theme-system', (e) => {\n  localStorage.removeItem('theme')\n  if (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n    document.documentElement.classList.add('dark')\n  } else {\n    document.documentElement.classList.remove('dark')\n  }\n  document.documentElement.classList.add('dark')\n})\n\n// #############################################################################\n// ####    C U S T O M    E V E N T    H A N D L E R S\n// #############################################################################\n\nwindow.addEventListener('phlegethon:clear', (e) => {\n  if (e?.target?.value != '') {\n    e.target.value = ''\n  }\n})\n\n// #############################################################################\n// ####    T I M E Z O N E    T O O L I N G\n// #############################################################################\nexport function getTimezone() {\n  return Intl.DateTimeFormat().resolvedOptions().timeZone\n}\n\nexport async function sendTimezoneToServer() {\n  const timezone = getTimezone()\n  let csrfToken = document\n    .querySelector(\"meta[name='csrf-token']\")\n    .getAttribute('content')\n\n  // Skip if we sent the timezone already or the timezone changed since last time we sent\n  if (\n    typeof window.localStorage != 'undefined' &&\n    (!localStorage['timezone'] || localStorage['timezone'] != timezone)\n  ) {\n    const response = await fetch('/session/set-timezone', {\n      method: 'POST',\n      mode: 'cors',\n      cache: 'no-cache',\n      credentials: 'same-origin',\n      headers: {\n        'Content-Type': 'application/json',\n        'x-csrf-token': csrfToken,\n      },\n      referrerPolicy: 'no-referrer',\n      body: JSON.stringify({ timezone: timezone }),\n    })\n\n    if (response.status === 200) {\n      localStorage['timezone'] = timezone\n    }\n  }\n}\n\n// #############################################################################\n// ####    H O O K S\n// #############################################################################\n\nexport const hooks = {\n  PhlegethonFlashComponent: {\n    mounted() {\n      this.oldMessageHTML = document.querySelector(\n        `#${this.el.id}-message`,\n      ).innerHTML\n      if (this.el.dataset.autoshow !== undefined) {\n        window.liveSocket.execJS(\n          this.el,\n          this.el.getAttribute('data-show-exec-js'),\n        )\n      }\n      resetHideTTL(this)\n    },\n    updated() {\n      newMessageHTML = document.querySelector(\n        `#${this.el.id}-message`,\n      ).innerHTML\n      if (newMessageHTML !== this.oldMessageHTML) {\n        this.oldEl = this.el\n        this.oldMessageHTML = newMessageHTML\n        resetHideTTL(this)\n      } else {\n        el.value = this.countdown\n      }\n    },\n    destroyed() {\n      clearInterval(this.ttlInterval)\n    },\n  },\n  PhlegethonNudgeIntoView: {\n    mounted() {\n      nudge(this.el)\n    },\n    updated() {\n      nudge(this.el)\n    },\n  },\n  PhlegethonAutocompleteComponent: {\n    mounted() {\n      this.el.addEventListener('keydown', (event) => {\n        switch (event.key) {\n          case 'ArrowDown':\n            this.pushEvent('select_item', {\n              index: (this.el.selectedIndex + 1) % this.el.options.length,\n            })\n            break\n          case 'ArrowUp':\n            this.pushEvent('select_item', {\n              index:\n                (this.el.selectedIndex - 1 + this.el.options.length) %\n                this.el.options.length,\n            })\n            break\n          case 'Enter':\n            // Implement your desired action on item selection\n            break\n          default:\n            break\n        }\n      })\n    },\n  },\n}\n\nfunction nudge(el) {\n  let width = window.innerWidth\n  let height = window.innerHeight\n  let rect = el.getBoundingClientRect()\n\n  hOffset = el.dataset.horizontalOffset || 0\n  vOffset = el.dataset.verticalOffset || 0\n\n  // TODO: The 24 padding is arbitrary -- look into a better way to figure out extra padding.\n\n  // Nudge left if offscreen\n  if (rect.right + 24 > width) {\n    el.style.right = hOffset\n    el.style.left = null\n  } else {\n    el.style.left = hOffset\n    el.style.right = null\n  }\n\n  // Nudge up if offscreen\n  if (rect.bottom + 24 > height) {\n    el.style.bottom = vOffset\n    el.style.top = null\n  } else {\n    el.style.top = vOffset\n    el.style.bottom = null\n  }\n}\n\nfunction resetHideTTL(self) {\n  clearInterval(self.ttlInterval)\n  if (self.el.dataset.ttl > 0) {\n    self.countdown = self.el.dataset.ttl\n    self.ttlInterval = setInterval(() => {\n      self.countdown = self.countdown - 16.7\n      if (self.countdown <= 0) {\n        window.liveSocket.execJS(\n          self.el,\n          self.el.getAttribute('data-hide-exec-js'),\n        )\n      } else {\n        el = document.querySelector(`#${self.el.id}>section>progress`)\n        if (el) {\n          el.value = self.countdown\n        } else {\n          clearInterval(self.ttlInterval)\n        }\n      }\n    }, 16.7)\n  }\n}\n"],
  "mappings": "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",
  "names": ["el"]
}
