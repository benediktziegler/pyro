var Phlegethon=(()=>{var h=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var k=Object.prototype.hasOwnProperty;var L=(e,s)=>{for(var n in s)h(e,n,{get:s[n],enumerable:!0})},b=(e,s,n,i)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of T(s))!k.call(e,o)&&o!==n&&h(e,o,{get:()=>s[o],enumerable:!(i=S(s,o))||i.enumerable});return e};var I=e=>b(h({},"__esModule",{value:!0}),e);var f=(e,s,n)=>new Promise((i,o)=>{var d=l=>{try{a(n.next(l))}catch(r){o(r)}},t=l=>{try{a(n.throw(l))}catch(r){o(r)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(d,t);a((n=n.apply(e,s)).next())});var A={};L(A,{booleanDataset:()=>E,focusAndSelect:()=>y,getTimezone:()=>v,hooks:()=>M,selectValue:()=>c,sendTimezoneToServer:()=>x,throttle:()=>w});localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");window.addEventListener("phlegethon:theme-dark",e=>{localStorage.theme="dark",document.documentElement.classList.add("dark")});window.addEventListener("phlegethon:theme-light",e=>{localStorage.theme="light",document.documentElement.classList.remove("dark")});window.addEventListener("phlegethon:theme-system",e=>{localStorage.removeItem("theme"),window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),document.documentElement.classList.add("dark")});window.addEventListener("phlegethon:clear",e=>{var s;((s=e==null?void 0:e.target)==null?void 0:s.value)!=""&&(e.target.value="")});function v(){return Intl.DateTimeFormat().resolvedOptions().timeZone}function x(){return f(this,null,function*(){let e=v(),s=document.querySelector("meta[name='csrf-token']").getAttribute("content");typeof window.localStorage!="undefined"&&(!localStorage.timezone||localStorage.timezone!=e)&&(yield fetch("/session/set-timezone",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json","x-csrf-token":s},referrerPolicy:"no-referrer",body:JSON.stringify({timezone:e})})).status===200&&(localStorage.timezone=e)})}var M={PhlegethonFlashComponent:{mounted(){var e;this.oldMessageHTML=document.querySelector(`#${this.el.id}-message`).innerHTML,((e=this.el.dataset)==null?void 0:e.autoshow)!==void 0&&window.liveSocket.execJS(this.el,this.el.getAttribute("data-show-exec-js")),g(this)},updated(){newMessageHTML=document.querySelector(`#${this.el.id}-message`).innerHTML,newMessageHTML!==this.oldMessageHTML?(this.oldEl=this.el,this.oldMessageHTML=newMessageHTML,g(this)):el.value=this.countdown},destroyed(){clearInterval(this.ttlInterval)}},PhlegethonNudgeIntoView:{mounted(){p(this.el)},updated(){p(this.el)}},PhlegethonAutocompleteComponent:{mounted(){this.lastValueSent=null;let e=()=>E(this.el.getAttribute("aria-expanded")),s=w(()=>{(this.lastValueSent!==this.el.value||!e())&&(this.lastValueSent=this.el.value,this.pushEventTo(this.el.dataset.myself,"search",this.el.value))},this.el.dataset.throttleTime);this.el.dataset.autofocus&&y(this.el);let n=()=>parseInt(this.el.dataset.selectedIndex),i=()=>{let t=document.getElementById(this.el.getAttribute("aria-controls"));return t!=null&&t.children?Array.from(t.children):[]},o=t=>{let a=parseInt(this.el.dataset.resultsCount);t=(t%a+a)%a,this.el.dataset.selectedIndex=t,i().forEach((l,r)=>{r===t?l.setAttribute("aria-selected",!0):l.removeAttribute("aria-selected")})},d=t=>{let a=n(),l=document.getElementById(this.el.dataset.inputId),r="",u="";if(a>-1){let m=i()[a];r=m.dataset.label,u=m.dataset.value}return t.preventDefault(),t.stopPropagation(),this.el.value=r,this.el.focus(),c(this.el),this.pushEventTo(this.el.dataset.myself,"pick",{label:r,value:u}),l.value=u,l.dispatchEvent(new Event("input",{bubbles:!0})),!1};this.el.addEventListener("keydown",t=>{switch(t.key){case"Tab":return e()?d(t):!0;case"Esc":case"Escape":return this.el.value!==""||!e()?(t.preventDefault(),t.stopPropagation(),this.el.value="",this.el.dataset.selectedIndex=-1,i().forEach((a,l)=>{a.removeAttribute("aria-selected")}),s(),!1):e()?(t.preventDefault(),t.stopPropagation(),this.el.value=this.el.dataset.savedLabel||"",c(this.el),this.pushEventTo(this.el.dataset.myself,"cancel"),this.lastValueSent=null,!1):!0;case"Enter":return e()?d(t):(this.el.value="",t.preventDefault(),t.stopPropagation(),s(),!1);case"Up":case"Down":case"ArrowUp":case"ArrowDown":if(e()){t.preventDefault(),t.stopPropagation();let a=n();return a=t.key==="ArrowUp"||t.key==="Up"?a-1:a+1,o(a),!1}else return!0;default:return!0}}),this.el.addEventListener("focus",t=>{c(this.el)}),this.el.addEventListener("input",t=>{switch(t.inputType){case"insertText":case"deleteContentBackward":case"deleteContentForward":return s(),!0;default:return!1}}),this.el.addEventListener("pick",t=>(o(t.detail.dispatcher.dataset.index),d(t)))}}};function p(e){var o,d;let s=window.innerWidth,n=window.innerHeight,i=e.getBoundingClientRect();hOffset=((o=e.dataset)==null?void 0:o.horizontalOffset)||0,vOffset=((d=e.dataset)==null?void 0:d.verticalOffset)||0,i.right+24>s?(e.style.right=hOffset,e.style.left=null):(e.style.left=hOffset,e.style.right=null),i.bottom+24>n?(e.style.bottom=vOffset,e.style.top=null):(e.style.top=vOffset,e.style.bottom=null)}function g(e){var s,n;clearInterval(e.ttlInterval),((s=e.el.dataset)==null?void 0:s.ttl)>0&&(e.countdown=(n=e.el.dataset)==null?void 0:n.ttl,e.ttlInterval=setInterval(()=>{e.countdown=e.countdown-16.7,e.countdown<=0?window.liveSocket.execJS(e.el,e.el.getAttribute("data-hide-exec-js")):(el=document.querySelector(`#${e.el.id}>section>progress`),el?el.value=e.countdown:clearInterval(e.ttlInterval))},16.7))}function w(e,s){let n=!1;return function(){n||(e.apply(this,arguments),n=!0,setTimeout(function(){e.apply(this,arguments),n=!1},s))}}function c(e){typeof e.select=="function"&&e.select()}function y(e){e.focus(),c(e)}function E(e){return![null,void 0,!1,"false"].includes(e)}return I(A);})();
